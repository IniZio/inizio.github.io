branches:
  only:
    - develop

language: node_js

sudo: true

node_js: stable

cache:
  directories:
  - node_modules

before_install:
  - rm -rf dist/
  - git config --global user.name "inizio"
  - git config --global user.email "digit4free@gmail.com"
  - git clone --branch master https://github.com/IniZio/inizio.github.io.git dist
  - npm i -g yarn --cache-min 999999999

install:
  - yarn

script:
  - npm run build

after_script:
  - cd dist
  # - echo "inizio.github.io" > CNAME
  - cp index.html 404.html
  - git add --all .
  - git commit --message "Automatically update from travis-ci"
  - git push "https://${GH_TOKEN}@${GH_REF}" master:master --quiet  > /dev/null 2>&1
